{{define "post"}}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Post.Title}}</title>
    <link rel="stylesheet" href="/static/css/post.css">
</head>
<body>
    {{template "header" .}}
    <div class="container">
        <h1>{{.Post.Title}}</h1>
        <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{.Category}}</p>
        <p><strong>–ê–≤—Ç–æ—Ä:</strong> {{.Author}}</p>
        <p>{{.Post.Body}}</p>
        <p><small>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{.Post.CreatedAt.Format "02.01.2006 15:04"}}</small></p>
        <a href="/all_posts">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫–æ –≤—Å–µ–º –ø–æ—Å—Ç–∞–º</a>

        <!-- Display like/dislike counts for the post -->
        <p>üëç {{.PostLikes}} | üëé {{.PostDislikes}}</p>

        {{if .User}}
        <!-- Like/Dislike buttons for the post -->
        <form action="/post/{{.Post.ID}}" method="POST" style="display: inline;">
            <input type="hidden" name="target_id" value="{{.Post.ID}}">
            <input type="hidden" name="target_type" value="post">
            <input type="hidden" name="is_like" value="true">
            <button type="submit">üëç –ù—Ä–∞–≤–∏—Ç—Å—è</button>
        </form>
        <form action="/post/{{.Post.ID}}" method="POST" style="display: inline;">
            <input type="hidden" name="target_id" value="{{.Post.ID}}">
            <input type="hidden" name="target_type" value="post">
            <input type="hidden" name="is_like" value="false">
            <button type="submit">üëé –ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è</button>
        </form>
        {{end}}
    </div>

<h3>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>
    {{if .User}}
        <!-- Comment form for logged-in users -->
        <form action="/comment" method="POST">
            <input type="hidden" name="post_id" value="{{.Post.ID}}">
            <textarea name="body" required></textarea>
            <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
    {{else}}
        <!-- Message for guests -->
        <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="/login">–≤–æ–π–¥–∏—Ç–µ</a> –∏–ª–∏ <a href="/register">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.</p>
    {{end}}

<h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
{{range .Comments}}
    <div class="comment">
        <p><strong>{{.Username}}</strong>: {{.Body}}</p>
        <p><small>–°–æ–∑–¥–∞–Ω–æ: {{.CreatedAt.Format "02.01.2006 15:04"}}</small></p>
        <!-- Display like/dislike counts for the comment -->
        <p>üëç Likes: {{ (index $.CommentCounts .ID).Likes }}</p>
        <p>üëé Dislikes: {{ (index $.CommentCounts .ID).Dislikes }}</p>

        {{if $.User}}
        <!-- Like/Dislike buttons for each comment -->
        <form action="/comment_like/{{.ID}}" method="POST" style="display: inline;">
            <input type="hidden" name="post_id" value="{{$.Post.ID}}">
            <input type="hidden" name="target_id" value="{{.ID}}">
            <input type="hidden" name="target_type" value="comment">
            <input type="hidden" name="is_like" value="true">
            <button type="submit">üëç –ù—Ä–∞–≤–∏—Ç—Å—è</button>
        </form>
        <form action="/comment_like/{{.ID}}" method="POST" style="display: inline;">
            <input type="hidden" name="post_id" value="{{$.Post.ID}}">
            <input type="hidden" name="target_id" value="{{.ID}}">
            <input type="hidden" name="target_type" value="comment">
            <input type="hidden" name="is_like" value="false">
            <button type="submit">üëé –ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è</button>
        </form>
        {{end}}
    </div>
{{else}}
    <p>–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.</p>
{{end}}

</body>
</html>
{{end}}